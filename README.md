# Laravel 12 Starter

A modern Laravel 12 starter template with batteries included:

- **Dockerized dev** via Laravel Sail
- **Spatie Permission** with enum-driven roles/permissions, ULID models
- **Horizon** for queues (gated to Super Admin)
- **Telescope** for debugging (gated to Super Admin)
- **Inertia + Vue 3** frontend
- **laravel-permission-to-vuejs** to expose roles/permissions to Vue

## Stack

- **Laravel**: 12.x
- **Auth**: Fortify (2FA-ready)
- **Permissions**: Spatie\Permission with custom models `App\Models\Role`, `App\Models\Permission` (ULIDs)
- **Enums**: `App\Enums\RolesEnum`, `App\Enums\PermissionsEnum`
- **Queues/Monitoring**: Horizon, Telescope
- **Frontend**: Inertia, Vue 3, Vite
- **Dev**: Sail (Docker)

## Quick Start

1) Install dependencies

```bash
composer install
npm install
```

2) Environment

```bash
cp .env.example .env
php artisan key:generate
```

3) Start Docker (Sail)

```bash
./vendor/bin/sail up -d
```

4) Migrate and seed

```bash
./vendor/bin/sail artisan migrate:fresh --seed
```

Seeding creates roles and permissions from enums and a default Super Admin user:

- Email: `superadmin@app.com`
- Password: generated by factory

5) Frontend dev server

```bash
./vendor/bin/sail composer run dev
```

## Roles & Permissions

- Roles are defined in `app/Enums/RolesEnum.php`:
  - `SUPERADMIN` (value: `super-admin`)
  - `ADMIN` (value: `admin`)
- Permissions are defined in `app/Enums/PermissionsEnum.php`
- Seeder: `database/seeders/RolesAndPermissionsSeeder.php`
  - Creates all roles/permissions
  - Grants all permissions to `SUPERADMIN`
  - Grants all except `delete-user` to `ADMIN`

View role-permission matrix:

```bash
./vendor/bin/sail artisan permission:show
```

### Spatie Permission Artisan Commands

Reference: https://spatie.be/docs/laravel-permission/v6/basic-usage/artisan

- Create a role
```bash
./vendor/bin/sail artisan permission:create-role "role-name" web
```

- Create a permission
```bash
./vendor/bin/sail artisan permission:create-permission "permission-name" web
```

- Show role/permission matrix
```bash
./vendor/bin/sail artisan permission:show
```

- Reset permission cache
```bash
./vendor/bin/sail artisan permission:cache-reset
```

## Creating Users via CLI

Interactive command that creates a user, assigns roles (via enum options), and emails a temporary password:

```bash
./vendor/bin/sail artisan app:create-user
```

The mailer uses `App\Mail\UserCreated` and view `resources/views/mail/user-created.blade.php`.

Configure mail in `.env` (for local testing you can use `MAIL_MAILER=log`).

## Horizon & Telescope Access

Access is restricted to Super Admin by gates:

- `App\Providers\AppServiceProvider`: allows Super Admin all abilities
- `App\Providers\HorizonServiceProvider`: `viewHorizon`
- `App\Providers\TelescopeServiceProvider`: `viewTelescope`

URLs (when running locally):

- Horizon: `/horizon`
- Telescope: `/telescope`

## Vue Permissions

`laravel-permission-to-vuejs` is wired to expose permissions/roles to Vue:

- Backend: `App\Models\User` uses `LaravelPermissionToVueJS` trait
- Blade: `resources/views/app.blade.php` injects `window.Laravel.jsPermissions`
- Frontend: plugin registered in `resources/js/app.ts`

Use in Vue to check roles/permissions on the client side.

## Database & IDs

- All core models use **ULIDs** (`HasUlids`), including users, roles, permissions, and pivot tables in the custom Spatie migration `database/migrations/2025_10_11_024311_create_permission_tables.php`.

## Common Commands

- Run tests
```bash
./vendor/bin/sail artisan test
```

- Code style
```bash
./vendor/bin/sail pint
```

- Rebuild database
```bash
./vendor/bin/sail artisan migrate:fresh --seed
```

## Notes

- Ensure Docker is installed and running for Sail.
- Adjust mail and queue configs in `.env` as needed.
- Modify enums to add more roles/permissions; re-run seeder to sync.
